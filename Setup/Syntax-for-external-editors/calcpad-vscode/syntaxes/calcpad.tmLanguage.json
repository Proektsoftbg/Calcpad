{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Calcpad",
  "scopeName": "source.calcpad",
  "fileTypes": ["cpd"],
  "patterns": [
    { "include": "#strings" },
    { "include": "#keywords" },
    { "include": "#methods" },
    { "include": "#functions" },
    { "include": "#string-variables" },
    { "include": "#numbers-with-units" },
    { "include": "#operators" },
    { "include": "#separators" },
    { "include": "#brackets" },
    { "include": "#variables" }
  ],
  "repository": {
    "html-tags": {
      "patterns": [
      {
        "name": "entity.name.tag.html",
        "match": "</?[A-Za-z][A-Za-z0-9:-]*\\b[^>]*?>"
      }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.calcpad",
          "begin": "\"",
          "end": "\"|$",
          "beginCaptures": {
            "0": { "name": "punctuation.definition.string.begin.calcpad" }
          },
          "endCaptures": {
            "0": { "name": "punctuation.definition.string.end.calcpad" }
          },
          "patterns": [
            {
              "name": "constant.character.escape.calcpad",
              "match": "\\\\."
            },
            {
            "include": "#html-tags"
            }
          ]
        },
        {
          "name": "string.quoted.single.calcpad",
          "begin": "'",
          "end": "'|$",
          "beginCaptures": {
            "0": { "name": "punctuation.definition.string.begin.calcpad" }
          },
          "endCaptures": {
            "0": { "name": "punctuation.definition.string.end.calcpad" }
          },
          "patterns": [
            {
              "name": "constant.character.escape.calcpad",
              "match": "\\\\."
            },
            {
              "include": "#html-tags"
            }
          ]
        }
      ]
    },
    "keywords": {
      "patterns": [
        {
		      "name": "keyword.control.calcpad",
          "match": "(#)([Rr]epeat|[Ll]oop|[Bb]reak|[Cc]ontinue|[Ss]how|[Hh]ide|[Pp]re|[Pp]ost|[Vv]al|[Ee]qu|[Nn]oc|[Nn]osub|[Nn]ovar|[Vv]arsub|[Rr]ad|[Dd]eg|[Gg]ra|[Ii]f|[Ee]lse|[Ee]lse\\s+[Ii]f|[Ee]nd\\s+[Ii]f|[Ff]or|[Ww]hile|[Ii]nclude|[Ll]ocal|[Gg]lobal|[Dd]ef|[Ee]nd\\s+[Dd]ef|[Pp]ause|[Ii]nput|[Ss]plit|[Ww]rap|[Pp]hasor|[Cc]omplex|[Aa]ppend|[Rr]ead|[Ww]rite|[Rr]ound|[Mm]d|[Mm]d\\s+[Oo]n|[Mm]d\\s+[Oo]ff)\\b"
        }
      ]
    },
    "methods": {
      "patterns": [
        {
		      "name": "support.method.calcpad",
          "match": "(\\$)([Rr]oot|[Ff]ind|[Ii]nf|[Ss]up|[Aa]rea|[Ii]ntegral|[Ss]lope|[Dd]erivative|[Ss]um|[Pp]roduct|[Rr]epeat|[Mm]ap|[Pp]lot|[Bb]lock|[Ii]nline|[Ww]hile)\\b"
        }
      ]
    },
    "functions": {
      "patterns": [
        {
          "name": "support.function.calcpad",
          "match": "\\b(sign|abs|mod|gcd|lcm|sin|cos|tan|csc|sec|cot|sinh|cosh|tanh|csch|sech|coth|asin|acos|atan|acsc|asec|acot|asinh|acosh|atanh|acsch|asech|acoth|ln|log|log_2|exp|sqr|sqrt|cbrt|round|floor|ceiling|trunc|re|im|phase|conj|random|root|atan2|min|max|sum|sumsq|srss|average|product|mean|switch|take|line|spline|not|and|or|xor|timer|vector|len|size|fill|range|join|resize|first|last|slice|sort|rsort|order|revorder|reverse|extract|search|count|find|find_eq|find_ne|find_lt|find_gt|find_le|find_ge|lookup|Lookup_eq|Lookup_ne|Lookup_lt|Lookup_gt|Lookup_le|Lookup_ge|norm|norm_1|norm_2|norm_e|norm_i|norm_p|unit|dot|cross|matrix|identity|diagonal|column|utriang|ltriang|symmetric|vec2diag|diag2vec|vec2col|vec2row|join_cols|join_rows|augment|stack|mfill|fill_row|fill_col|mresize|copy|add|n_rows|n_cols|row|col|extract_rows|extract_cols|submatrix|mnorm|mnorm_2|mnorm_e|mnorm_1|mnorm_i|cond|cond_1|cond_2|cond_e|cond_i|det|rank|transp|trace|inverse|adj|cofactor|eigenvals|eigenvecs|eigen|lu|qr|svd|cholesky|lsolve|clsolve|slsolve|msolve|cmsolve|smsolve|hprod|fprod|kprod|sort_cols|rsort_cols|sort_rows|rsort_rows|order_cols|revorder_cols|order_rows|revorder_rows|mcount|mfind|mfind_eq|mfind_ne|mfind_lt|mfind_le|mfind_gt|mfind_ge|msearch|hlookup|hlookup_eq|hlookup_ne|hlookup_lt|hlookup_le|hlookup_gt|hlookup_ge|vlookup|vlookup_eq|vlookup_ne|vlookup_lt|vlookup_le|vlookup_gt|vlookup_ge|getunits|setunits|clrunits|hp|ishp|vector_hp|range_hp|matrix_hp|identity_hp|diagonal_hp|column_hp|utriang_hp|ltriang_hp|symmetric_hp|matmul|if)\\b"
        }
      ]
    },
    "string-variables": {
      "patterns": [
        {
          "name": "meta.string.calcpad",
          "match": "[a-zA-Z]+[a-zA-Z0-9_]*\\$"
        }
      ]
    },
    "numbers-with-units": {
      "patterns": [
        {
          "match": "\\b([0-9]*\\.?[0-9]+)([A-Za-z°Ωμ℧]+)?\\b",
          "captures": {
            "1": { "name": "constant.numeric.calcpad" },
            "2": { "name": "entity.name.constant.calcpad" }
          }
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "name": "keyword.operator.arithmetic.calcpad",
          "match": "[\\^/÷\\\\%*\\-+∠]"
        },
        {
          "name": "keyword.operator.comparison.calcpad",
          "match": "[≡≠<>≤≥]"
        },
        {
          "name": "keyword.operator.logical.calcpad",
          "match": "[∧∨⊕]"
        },
        {
          "name": "keyword.operator.assignment.calcpad",
          "match": "="
        }
      ]
    },
    "separators": {
      "patterns": [
        {
          "name": "punctuation.separator.calcpad",
          "match": "[;&@:|]"
        }
      ]
    },
    "brackets": {
      "patterns": [
        {
          "name": "punctuation.section.brackets.calcpad",
          "match": "[\\[\\{()\\}\\]]"
        }
      ]
    },
    "variables": {
      "patterns": [
        {
          "name": "variable.other.calcpad",
          "match": "\\b[a-zA-Zα-ωΑ-Ω°øØ∡]+[a-zA-Zα-ωΑ-Ω°øØ∡0-9_,′″‴⁗⁰¹²³⁴⁵⁶⁷⁸⁹ⁿ⁺⁻]*\\b"
        }
      ]
    }
  }
}
